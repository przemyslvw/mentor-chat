<div class="forgot-password-container">
  <h2>Resetowanie hasła</h2>

  <div *ngIf="!isEmailSent; else emailSent">
    <p>Wprowadź adres email powiązany z Twoim kontem, a wyślemy Ci link do zresetowania hasła.</p>

    <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Email</mat-label>
        <input matInput type="email" formControlName="email" required />
        <mat-error *ngIf="forgotPasswordForm.get('email')?.hasError('required')">
          Email jest wymagany
        </mat-error>
        <mat-error *ngIf="forgotPasswordForm.get('email')?.hasError('email')">
          Wprowadź poprawny adres email
        </mat-error>
      </mat-form-field>

      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="forgotPasswordForm.invalid || isLoading"
        class="submit-button"
      >
        <mat-spinner *ngIf="isLoading" diameter="20" class="spinner"></mat-spinner>
        <span *ngIf="!isLoading">Wyślij link resetujący</span>
      </button>

      <div *ngIf="error" class="error-message">
        {{ error }}
      </div>
    </form>
  </div>

  <ng-template #emailSent>
    <div class="success-message">
      <mat-icon class="success-icon">check_circle</mat-icon>
      <h3>Sprawdź swoją skrzynkę pocztową</h3>
      <p>
        Wysłaliśmy link do zresetowania hasła na adres
        <strong>{{ forgotPasswordForm.get('email')?.value }}</strong
        >.
      </p>
      <p>Jeśli nie widzisz wiadomości, sprawdź folder ze spamem.</p>
    </div>
  </ng-template>

  <div class="back-to-login">
    <a routerLink="/auth/login"> <mat-icon>arrow_back</mat-icon> Powrót do logowania </a>
  </div>
</div>
